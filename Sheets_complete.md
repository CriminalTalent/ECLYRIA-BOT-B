# Google Sheets 시트 구조 완전 정리

## 📌 필수 시트 목록
1. [스탯 시트](#1-스탯-시트) - 캐릭터 전투 스탯
2. [사용자 시트](#2-사용자-시트) - 아이템 및 갈레온
3. [조사 시트](#3-조사-시트) - 조사 대상 및 결과
4. [조사상태 시트](#4-조사상태-시트) - 조사 진행 상태
5. [조사로그 시트](#5-조사로그-시트) - 조사 기록

---

## 1. 스탯 시트

### 시트 이름
```
스탯
```

### 헤더 (첫 행)
```
ID | 이름 | HP | 공격 | 방어 | 민첩 | 행운 | 마지막조사일
```

### 열 설명
| 열 | 필드명 | 데이터 타입 | 필수 | 기본값 | 설명 |
|----|--------|-------------|------|--------|------|
| A | ID | 텍스트 | O | - | 마스토돈 계정 (@user@server.com) |
| B | 이름 | 텍스트 | O | - | 캐릭터 이름 |
| C | HP | 정수 | O | 100 | 현재 체력 (0~100) |
| D | 공격 | 정수 | O | 10 | 공격 스탯 |
| E | 방어 | 정수 | O | 10 | 방어 스탯 |
| F | 민첩 | 정수 | O | 10 | 민첩 스탯 |
| G | 행운 | 정수 | O | 10 | 행운 스탯 |
| H | 마지막조사일 | 날짜 | X | - | 조사 날짜 (YYYY-MM-DD) |

### 예시 데이터
```
ID                              이름      HP   공격  방어  민첩  행운  마지막조사일
@alice@server.com               Alice     100  15    12    10    8     2025-12-01
@bob@server.com                 Bob       85   12    10    15    12    2025-12-01
@charlie@server.com             Charlie   100  10    15    8     5     
```

### 스탯 권장값
```
전사형:   공격 15, 방어 12, 민첩 8,  행운 5
도적형:   공격 12, 방어 8,  민첩 15, 행운 10
마법사형: 공격 10, 방어 6,  민첩 10, 행운 14
탱커형:   공격 8,  방어 15, 민첩 7,  행운 5
균형형:   공격 10, 방어 10, 민첩 10, 행운 10

총합: 40~45 정도 권장
```

### 주의사항
- ID는 전체 마스토돈 계정 (@user@server.com)
- HP는 0~100 범위
- 스탯은 양수
- 마지막조사일은 자동 업데이트

---

## 2. 사용자 시트

### 시트 이름
```
사용자
```

### 헤더 (첫 행)
```
사용자 ID | 갈레온 | 아이템 | 마지막베팅날짜 | 기숙사 | 공격력 | 출석날짜 | 마지막타로날짜 | 기숙사점수 | 마지막베팅횟수
```

### 열 설명
| 열 | 필드명 | 데이터 타입 | 필수 | 기본값 | 설명 |
|----|--------|-------------|------|--------|------|
| A | 사용자 ID | 텍스트 | O | - | 마스토돈 계정 |
| B | 갈레온 | 정수 | O | 0 | 소지 갈레온 (화폐) |
| C | 아이템 | 텍스트 | X | - | 소지 아이템 (쉼표 구분) |
| D | 마지막베팅날짜 | 날짜 | X | - | 베팅 날짜 |
| E | 기숙사 | 텍스트 | X | - | 소속 기숙사 |
| F | 공격력 | 정수 | X | - | 추가 공격력 |
| G | 출석날짜 | 날짜 | X | - | 출석 날짜 |
| H | 마지막타로날짜 | 날짜 | X | - | 타로 날짜 |
| I | 기숙사점수 | 정수 | X | 0 | 기숙사 점수 |
| J | 마지막베팅횟수 | 정수 | X | 0 | 베팅 횟수 |

### 예시 데이터
```
사용자 ID              갈레온  아이템                         기숙사
@alice@server.com      500     소형물약,중형물약,검           그리핀도르
@bob@server.com        1200    대형물약,마법서,비밀문서       슬리데린
@charlie@server.com    300     소형물약                       래번클로
```

### 아이템 형식
```
단일 아이템:
소형물약

여러 아이템 (쉼표로 구분, 공백 주의):
소형물약,중형물약,검

물약 종류:
소형물약  (회복 10)
중형물약  (회복 30)
대형물약  (회복 50)
물약      (회복 20, 기본)
```

### 주의사항
- 아이템은 쉼표(,)로만 구분
- 물약 이름은 정확히 일치해야 함
- 갈레온은 음수 불가

---

## 3. 조사 시트

### 시트 이름
```
조사
```

### 헤더 (첫 행)
```
위치 | 세부조사 | 위치설명 | 종류 | 난이도 | 성공결과 | 실패결과
```

### 열 설명
| 열 | 필드명 | 데이터 타입 | 필수 | 설명 |
|----|--------|-------------|------|------|
| A | 위치 | 텍스트 | O | 조사 가능한 위치명 |
| B | 세부조사 | 텍스트 | X | 세부 조사 대상 (위치 내) |
| C | 위치설명 | 텍스트 | X | 위치 개요 설명 |
| D | 종류 | 텍스트 | O | 조사/정밀조사/감지/훔쳐보기/DM조사 |
| E | 난이도 | 정수 | O | 성공 판정 기준값 |
| F | 성공결과 | 텍스트 | O | 판정 성공 시 메시지 |
| G | 실패결과 | 텍스트 | O | 판정 실패 시 메시지 |

### 예시 데이터 (일반 조사)
```
위치      세부조사  위치설명                     종류      난이도  성공결과                                실패결과
도서관              오래된 책들이 가득한 도서관   조사      10      고서에서 비밀 지도를 발견했습니다        특별한 것을 찾지 못했습니다
도서관    고서                                  정밀조사   15      마법진이 그려진 지도 [아이템:지도]      내용이 너무 손상되었습니다
복도                긴 복도입니다                조사      12      바닥에 발자국을 발견했습니다            평범한 복도입니다
```

### 예시 데이터 (공동목표 연동)
```
위치           세부조사  위치설명  종류      난이도  성공결과                                          실패결과
지하 2층 단서                     조사      10      순혈주의 활동가의 은신처를 발견했습니다            희미한 흔적만 보입니다
지하 3층 단서                     정밀조사   15      집행자의 작전 계획서 발견 [아이템:작전서] [갈레온:50]  중요한 정보는 없습니다
지하 4층 단서                     감지      20      강력한 마법 흔적 감지 [갈레온:100]                특별한 것을 느끼지 못했습니다
지하 5층 단서                     훔쳐보기   25      핵심인물의 비밀 서신 [아이템:서신] [갈레온:200]    경계가 너무 삼엄합니다
```

### 조사 종류
| 종류 | 설명 | 난이도 권장 | 비고 |
|------|------|-------------|------|
| 조사 | 기본 조사 | 10-15 | 가장 쉬움 |
| 정밀조사 | 상세 조사 | 15-20 | 중간 |
| 감지 | 마법/기운 | 20-25 | 어려움 |
| 훔쳐보기 | 은밀 관찰 | 25-30 | 매우 어려움 |
| DM조사 | DM 전용 | - | 특수 |

### 보상 태그
```
아이템 지급:
[아이템:아이템명]
예: "지도 발견 [아이템:비밀지도]"

갈레온 지급:
[갈레온:숫자]
예: "보물 상자 [갈레온:100]"

복합:
[아이템:보물] [갈레온:500]
```

### 난이도 가이드
```
5-10:   매우 쉬움 (90% 성공률)
11-15:  쉬움 (75% 성공률)
16-20:  보통 (50% 성공률)
21-25:  어려움 (30% 성공률)
26-30:  매우 어려움 (10% 성공률)
31+:    거의 불가능 (5% 이하)

* 행운 10 기준
```

### 구조 설명
```
위치 구조:
A열 (위치)       B열 (세부조사)    설명
도서관                            위치 개요
                고서              세부 조사 대상
                비밀방            세부 조사 대상
복도                             위치 개요
                그림              세부 조사 대상

공동목표 구조:
A열 (위치)       B열 (세부조사)    설명
지하 2층 단서                      층 단서
지하 3층 단서                      층 단서
```

---

## 4. 조사상태 시트

### 시트 이름
```
조사상태
```

### 헤더 (첫 행)
```
사용자 ID | 조사상태 | 위치 | 은밀도 | 협력상태 | 이동포인트
```

### 열 설명
| 열 | 필드명 | 데이터 타입 | 설명 |
|----|--------|-------------|------|
| A | 사용자 ID | 텍스트 | 마스토돈 계정 |
| B | 조사상태 | 텍스트 | 없음/진행중/완료 |
| C | 위치 | 텍스트 | 현재 조사 위치 |
| D | 은밀도 | 정수 | 은신 수치 (0-100) |
| E | 협력상태 | 텍스트 | 협력조사:상대명 / 방해 / - |
| F | 이동포인트 | 정수 | 남은 이동 횟수 (0-3) |

### 예시 데이터
```
사용자 ID              조사상태  위치      은밀도  협력상태          이동포인트
@alice@server.com      진행중    도서관    50      -                 3
@bob@server.com        진행중    복도      30      협력조사:alice    2
@charlie@server.com    없음      -         0       -                 3
```

### 상태 값
```
조사상태:
- 없음: 조사 시작 전
- 진행중: 조사 진행 중
- 완료: 조사 완료

협력상태:
- -: 없음
- 협력조사:상대명: 협력 진행 중
- 방해: 방해받음 (다음 판정 -3)

이동포인트:
- 0-3: 남은 이동 횟수
- 자정에 3으로 초기화
```

---

## 5. 조사로그 시트

### 시트 이름
```
조사로그
```

### 헤더 (첫 행)
```
시간 | 사용자 ID | 위치 | 대상 | 종류 | 결과 | 내용
```

### 열 설명
| 열 | 필드명 | 데이터 타입 | 설명 |
|----|--------|-------------|------|
| A | 시간 | 날짜시간 | YYYY-MM-DD HH:MM |
| B | 사용자 ID | 텍스트 | 조사자 계정 |
| C | 위치 | 텍스트 | 조사 위치 |
| D | 대상 | 텍스트 | 조사 대상 |
| E | 종류 | 텍스트 | 조사 종류 |
| F | 결과 | 텍스트 | 성공/실패 |
| G | 내용 | 텍스트 | 결과 내용 |

### 예시 데이터
```
시간              사용자 ID            위치       대상        종류      결과  내용
2025-12-01 10:30  @alice@server.com    도서관     고서        정밀조사  성공  마법진이 그려진 지도를 발견...
2025-12-01 10:35  @bob@server.com      복도       그림        조사      실패  특별한 것을 찾지 못했습니다
2025-12-01 11:00  @alice@server.com    지하 3층   지하 3층 단서  정밀조사  성공  집행자의 작전 계획서 발견...
```

### 자동 기록
```
기록 시점:
1. 조사 판정 성공/실패 시
2. 세부조사 완료 시
3. 협력조사 완료 시
4. 공동목표 이동 중 단서 발견 시

기록 내용:
- 시간 자동 기록
- 판정 결과 자동 기록
- 보상 지급 여부 기록
```

---

## 시트 관계도

```
스탯 시트 (전투용)
    ↓
    전투 시스템
    ↓
    HP 업데이트

사용자 시트 (아이템/갈레온)
    ↓
    물약 사용 / 조사 보상
    ↓
    아이템/갈레온 업데이트

조사 시트 (조사 정의)
    ↓
    조사 시스템 / 공동목표
    ↓
    조사상태 시트 (진행 상태)
    ↓
    조사로그 시트 (기록)
```

---

## 초기 설정 가이드

### 1단계: 스프레드시트 생성
```
1. Google Sheets 새 스프레드시트 생성
2. 스프레드시트 ID 복사
   URL: https://docs.google.com/spreadsheets/d/[여기가_ID]/edit
```

### 2단계: 시트 생성
```
1. 기본 시트 이름 변경 → "스탯"
2. 새 시트 추가:
   - 사용자
   - 조사
   - 조사상태
   - 조사로그
```

### 3단계: 헤더 입력
```
각 시트 첫 행에 헤더 입력
(위 각 시트별 헤더 참조)
```

### 4단계: 권한 설정
```
1. Google Cloud Console에서 서비스 계정 생성
2. JSON 키 다운로드
3. 스프레드시트 공유 → 서비스 계정 이메일 추가 (편집자 권한)
```

### 5단계: 테스트 데이터 입력
```
스탯 시트:
@test@server.com | Test | 100 | 10 | 10 | 10 | 10 |

사용자 시트:
@test@server.com | 1000 | 소형물약,중형물약 | | | | | | |

조사 시트:
테스트 위치 | | 테스트 장소입니다 | 조사 | 10 | 성공했습니다 | 실패했습니다

조사상태 시트:
@test@server.com | 없음 | - | 0 | - | 3
```

---

## 데이터 관리

### 백업
```
정기적 백업 권장:
1. 파일 → 사본 만들기
2. 다운로드 → Excel 형식
3. 버전 기록 활용
```

### 데이터 정리
```
조사로그 시트:
- 오래된 로그 정리 (월 1회)
- 또는 별도 시트로 이동

조사상태 시트:
- 비활성 사용자 정리
- 이동포인트 자동 초기화 (스크립트 권장)
```

### 데이터 무결성
```
필수 확인:
1. ID 중복 없음
2. 스탯 양수 값
3. HP 0-100 범위
4. 아이템 형식 (쉼표 구분)
5. 날짜 형식 (YYYY-MM-DD)
```

---

## 문제 해결

### 봇이 시트를 못 읽는 경우
```
1. 서비스 계정 권한 확인 (편집자)
2. 시트 이름 확인 (정확히 일치)
3. 헤더 행 확인 (첫 행)
4. GOOGLE_SHEET_ID 확인
```

### 사용자를 찾을 수 없는 경우
```
1. ID 형식 확인 (@user@server.com)
2. 대소문자 정확히 일치
3. 공백 없음
4. 스탯/사용자 양쪽 시트 모두 등록
```

### 조사가 작동하지 않는 경우
```
1. 조사 시트 헤더 확인
2. 위치명 정확히 일치
3. 난이도 숫자 타입
4. 성공/실패 결과 입력
```

---

## 템플릿 다운로드

### 빈 템플릿
모든 시트와 헤더만 설정된 빈 템플릿:
```
스프레드시트 생성 후 위 구조대로 설정
```

### 예시 데이터 템플릿
테스트 데이터가 포함된 템플릿:
```
실제 사용 전 예시 데이터 삭제 필요
```

---

**시트 설정이 완료되면 봇이 자동으로 읽고 쓸 수 있습니다!**
